# 更新日志 / Changelog

所有重要的项目更改都将记录在此文件中。

---

## [v1.1] - 2025-10-26（expand分支）

### ✨ 新增功能

#### 备份功能增强
- **实时进度显示** - 手动执行备份时显示实时进度对话框
  - 进度条显示完成百分比
  - 显示当前处理的文件
  - 详细日志输出（可折叠）
  - 支持取消操作
- **定时备份静默运行** - 定时任务在后台执行，不显示进度对话框
- **备份参数增强** - 支持排除规则（--exclude）和自定义标签
  - 可配置多个排除模式
  - 为备份任务添加自定义标签
  - 标签可用于筛选和组织快照

#### 仓库管理增强
- **快照信息自动获取** - 仓库快照数和大小自动从restic获取
  - 点击选择仓库时自动更新快照信息
  - 无需手动刷新即可看到最新数据
  - 支持从缓存快速读取

#### 用户界面增强
- **密码输入对话框** - 完整的密码输入对话框实现
  - 支持显示/隐藏密码
  - 密码强度指示
  - 友好的错误提示
- **向导式任务创建** - 创建备份任务使用向导界面
  - 步骤清晰，引导明确
  - 支持多路径选择
  - 可视化配置排除规则

### 🎨 界面优化

- **主页面优化** - 改进首页布局和信息展示
- **仓库管理页** - 优化仓库列表和详情显示
- **备份任务页** - 增强任务列表和历史记录展示
- **快照管理页** - 改进快照浏览和操作界面
- **数据恢复页** - 优化恢复流程和文件选择界面
- **统计信息页** - 增强数据统计和图表展示

### 🐛 Bug 修复

- **修复输入密码后卡顿问题** - 优化密码输入后的界面响应速度
- **修复快照总数统计错误** - 准确统计仓库中的快照数量
- **修复备份标签功能** - 标签正确保存和显示

### 🔧 技术改进

- **代码重构** - 优化多处代码结构，提高可维护性
- **性能优化** - 改进数据加载和界面响应速度
- **错误处理** - 增强错误提示和异常处理

### 📊 代码统计

- **文件数：** 79个（增加4个）
- **代码行数：** ~14,815行（增加约3,500行）
- **UI文件：** 10个
- **提交次数：** 32次（2025-10-20至今）

---

## [v1.0] - 2025-10-24

### ✅ 核心功能实现

#### 仓库管理
- 创建本地和远程仓库（支持SFTP、S3、REST等）
- 连接已有仓库
- 仓库完整性检查
- 仓库修复和解锁
- 仓库清理（Prune）

#### 备份管理
- 创建备份任务（支持多路径、排除规则）
- 手动执行备份
- 定时自动备份
- 备份历史记录
- 备份任务启用/禁用

#### 快照管理
- 浏览所有快照
- 查看快照详情
- 删除快照
- 快照标签管理
- 快照比较

#### 数据恢复
- 浏览快照文件树
- 文件搜索
- 选择性恢复
- 恢复向导

#### 统计信息
- 仓库统计
- 备份趋势
- 存储分析
- 去重效率

### 🏗️ 架构设计

#### 三层架构
- **UI层** - Qt Widgets + .ui文件
- **业务逻辑层** - 6个单例管理器
- **数据访问层** - SQLite + QSettings

#### 核心管理器
- ResticWrapper - restic CLI封装
- RepositoryManager - 仓库管理
- BackupManager - 备份管理
- RestoreManager - 恢复管理
- SnapshotManager - 快照管理
- SchedulerManager - 任务调度

### 📦 UI实现

#### .ui文件（10个）
- 1个主窗口
- 6个页面
- 3个对话框

#### 纯代码组件
- 2个向导（CreateRepoWizard、RestoreWizard）
- 3个对话框（CreateTaskDialog、PasswordDialog、SnapshotBrowserDialog）
- 2个自定义控件（FileTreeWidget、SnapshotListWidget）

### 📋 数据库设计

#### 表结构
- repositories - 仓库配置
- backup_tasks - 备份任务
- backup_history - 备份历史
- settings - 应用设置
- password_store - 密码存储
- snapshots_cache - 快照缓存

### 📚 文档完善

- 需求规格说明书（26KB）
- 概要设计文档（39KB）
- 详细设计文档（60KB）
- 数据库设计文档（23KB）
- 界面原型设计文档（60KB）

### 🚀 技术栈

- Qt 5.14
- C++ 17
- SQLite 3
- qmake
- restic CLI

---

## 版本说明

### 版本编号规则
- **主版本号** - 重大架构变更或功能重构
- **次版本号** - 新功能添加或重要改进
- **修订号** - Bug修复和小改进

### 分支说明
- **master** - 稳定版本，已充分测试
- **expand** - 开发分支，包含最新功能
- **feature/** - 功能开发分支
- **bugfix/** - Bug修复分支

---

## 贡献指南

欢迎贡献代码！请遵循以下步骤：

1. Fork 本仓库
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启 Pull Request

---

## 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件

Restic 采用 BSD 2-Clause 许可证

---

**项目主页：** https://github.com/yourname/restic-gui
**问题反馈：** https://github.com/yourname/restic-gui/issues

**开发状态：** ✅ 活跃开发中
**最后更新：** 2025-10-26
