# Restic GUI 界面原型设计文档

**项目名称：** Restic GUI
**版本：** 1.1
**编写日期：** 2025-10-24
**文档状态：** 实现完成版
**实现方式：** Qt Designer .ui 文件（10个.ui文件）+ 纯代码（向导和自定义控件）

---

## 1. 设计原则

### 1.1 向导式设计

所有复杂操作（创建仓库、创建备份任务、恢复数据等）都采用向导式界面，引导用户逐步完成。

### 1.2 中文界面

所有界面元素、提示信息、帮助文档均使用中文。

### 1.3 直观易用

- 使用图标增强识别性
- 提供上下文帮助
- 操作结果即时反馈
- 危险操作二次确认

### 1.4 响应式布局

- 最小窗口尺寸：1024x768
- 支持窗口缩放
- 关键信息优先显示

### 1.5 UI 实现方式说明

项目采用**Qt Designer .ui 文件**和**纯代码**相结合的方式实现界面：

**使用 .ui 文件的组件（10个）：**
- **主窗口：** MainWindow.ui
- **页面（6个）：** HomePage.ui, RepositoryPage.ui, BackupPage.ui, SnapshotPage.ui, RestorePage.ui, StatsPage.ui
- **对话框（3个）：** ProgressDialog.ui, SettingsDialog.ui, PruneOptionsDialog.ui

**使用纯代码的组件：**
- **向导：** CreateRepoWizard（5步动态向导）
- **对话框：** CreateTaskDialog, SnapshotBrowserDialog（复杂逻辑）
- **自定义控件：** FileTreeWidget, SnapshotListWidget（自定义绘制）

**实现模式：**
```cpp
// .ui 文件方式
#include "ui_MainWindow.h"
class MainWindow {
    Ui::MainWindow* ui;  // 通过 ui-> 访问控件
};

// 纯代码方式
class CreateRepoWizard {
    QLabel* m_titleLabel;  // 通过 m_ 前缀访问控件
};
```

**优势：**
- 标准界面可视化设计，提高开发效率
- 复杂逻辑保持代码灵活性
- UI与业务逻辑分离，易于维护

---

## 2. 主窗口设计

### 2.1 整体布局

```
┌─────────────────────────────────────────────────────────────────────────┐
│  Restic GUI - 简单易用的备份工具                         [_] [□] [X]    │
├─────────────────────────────────────────────────────────────────────────┤
│  文件(F)  帮助(H)                                              │
├───────────┬─────────────────────────────────────────────────────────────┤
│           │                                                             │
│  [图标]    │                                                             │
│  首  页    │                                                             │
│           │                                                             │
│  ─────    │                                                             │
│           │                                                             │
│  [图标]    │                                                             │
│  仓库管理   │                   主内容区域                                 │
│           │                   (QStackedWidget)                          │
│  [图标]    │                                                             │
│  备份任务   │                                                             │
│           │                                                             │
│  [图标]    │                                                             │
│  快照管理   │                                                             │
│           │                                                             │
│  [图标]    │                                                             │
│  恢复数据   │                                                             │
│           │                                                             │
│  [图标]    │                                                             │
│  统计信息   │                                                             │
│           │                                                             │
│  ─────    │                                                             │
│           │                                                             │
│  [图标]    │                                                             │
│  设  置    │                                                             │
│           │                                                             │
├───────────┴─────────────────────────────────────────────────────────────┤
│  当前仓库: 本地备份仓库  │  最后备份: 2025-10-20 14:30  │  状态: 就绪  │
└─────────────────────────────────────────────────────────────────────────┘
```

**尺寸：**
- 窗口宽度：1200px
- 窗口高度：800px
- 左侧导航栏宽度：200px

**颜色：**
- 导航栏背景：浅灰色 (#F5F5F5)
- 选中项背景：浅蓝色 (#E3F2FD)
- 主内容区背景：白色 (#FFFFFF)

---

## 3. 首页设计

### 3.1 首页布局

```
┌─────────────────────────────────────────────────────────────────────────┐
│  欢迎使用 Restic GUI                                                      │
│                                                                         │
│  ┌──────────────────┐  ┌──────────────────┐  ┌──────────────────┐       │
│  │   [大图标]        │  │   [大图标]       │  │   [大图标]         │       │
│  │                  │  │                 │  │                   │       │
│  │   创建新仓库       │  │   创建备份任务    │  │   恢复数据          │       │
│  │                  │  │                 │  │                   │       │
│  │   快速开始使用     │  │   配置自动备份    │  │   从快照恢复         │    	│
│  │   Restic备份     │  │   保护您的数据     │  │   找回文件          │   	   │
│  │                 │  │                  │  │                   │    	  │
│  │   [开始创建]      │  │   [开始创建]      │  │   [开始恢复]        │      │
│  └──────────────────┘  └──────────────────┘  └──────────────────┘    	  │
│                                                                         │
│  ─────────────────────────────────────────────────────────────────      │
│                                                                         │
│  最近活动                                                                │
│  ┌───────────────────────────────────────────────────────────────┐      │
│  │  [图标] 工作文档备份 - 成功                2025-10-20 14:30       │      │
│  │  → 快照ID: a3f5c8d2  │  新增: 8个文件  │  125 MB                 │      │
│  ├───────────────────────────────────────────────────────────────┤      │
│  │  [图标] 家庭照片备份 - 成功                2025-10-20 10:00       │      │
│  │  → 快照ID: b9k2x1m4  │  新增: 23个文件 │  520 MB                 │      │
│  ├───────────────────────────────────────────────────────────────┤      │
│  │  [图标] 系统备份 - 失败                    2025-10-19 22:30      │      │
│  │  → 错误: 网络连接超时                                            │      │
│  └───────────────────────────────────────────────────────────────┘      │
│                                                                         │
│  快捷统计                                                                 │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │
│  │  仓库总数    │  │  备份任务     │  │  快照总数     │  │  总存储量    │     │
│  │             │  │             │  │             │  │             │     │
│  │      3      │  │      5      │  │     128     │  │   125 GB    │     │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘     │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

**交互：**
- 点击三个快捷卡片可直接启动相应向导
- 点击最近活动条目可查看详情
- 点击统计数字可跳转到相应页面

---

## 4. 仓库管理页面

### 4.1 仓库列表

```
┌─────────────────────────────────────────────────────────────────────────┐
│  仓库管理                                    [+ 创建新仓库] [连接已有仓库]│
│                                                                         │
│  ┌───┬──────────────┬──────┬──────────────┬────────┬───────┬────────┐   │
│  │默认│ 仓库名称      │ 类型 │ 位置           │ 快照数 │ 大小  │ 操作      │   │
│  ├───┼──────────────┼──────┼──────────────┼────────┼───────┼────────┤   │
│  │ ★ │ 本地备份仓库  │ 本地  │ /srv/restic  │  85     │ 45GB │ [...]  │    │
│  ├───┼──────────────┼──────┼──────────────┼────────┼───────┼────────┤   │
│  │   │ 远程SFTP仓库  │ SFTP │192.168.1.100 │  43    │ 28GB  │ [...]  │    │
│  ├───┼──────────────┼──────┼──────────────┼────────┼───────┼────────┤   │
│  │   │ S3云端仓库    │ S3   │ my-backup    │  120   │ 98GB  │ [...]   │   │
│  └───┴──────────────┴──────┴──────────────┴────────┴───────┴────────┘   │
│                                                                         │
│  选中仓库详情： 本地备份仓库                                                 │
│  ┌───────────────────────────────────────────────────────────────┐      │
│  │  名称：         本地备份仓库                                      │     │
│  │  类型：         本地文件系统                                      │     │
│  │  路径：         /srv/restic-repo                                │     │
│  │  创建时间：     2025-08-15 10:30:00                              │     │
│  │  最后备份：     2025-10-20 14:30:00                              │     │
│  │  快照数量：     85                                               │     │
│  │  总大小：       45.2 GB                                         │     │
│  │  原始数据：     180.5 GB（去重率：75%）                            │     │
│  │                                                                │     │
│  │  [检查仓库]  [编辑配置]  [清理仓库]  [删除仓库]                      │     │
│  └──────────────────────────────────────────────────────────────-─┘     │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

**操作菜单（[...]）：**
- 设为默认
- 检查仓库
- 编辑配置
- 清理仓库
- 删除仓库

---

## 5. 备份任务页面

### 5.1 任务列表

```
┌─────────────────────────────────────────────────────────────────────────┐
│  备份任务                                              [+ 创建新任务]    │
│                                                                         │
│  ┌──────────────┬────────────┬──────────┬────────┬────────┬─────────┐ │
│  │ 任务名称      │ 目标仓库   │ 备份路径 │ 调度   │ 状态   │ 操作   │ │
│  ├──────────────┼────────────┼──────────┼────────┼────────┼─────────┤ │
│  │ 工作文档备份  │ 本地备份... │ 1个路径  │ 每天   │ [启用] │ [详情] │ │
│  │              │            │          │ 02:00  │        │ [▶立即]│ │
│  │              │            │          │        │        │ [编辑] │ │
│  ├──────────────┼────────────┼──────────┼────────┼────────┼─────────┤ │
│  │ 家庭照片备份  │ S3云端仓库 │ 2个路径  │ 每周日 │ [启用] │ [详情] │ │
│  │              │            │          │ 02:00  │        │ [▶立即]│ │
│  │              │            │          │        │        │ [编辑] │ │
│  ├──────────────┼────────────┼──────────┼────────┼────────┼─────────┤ │
│  │ 系统配置备份  │ 本地备份... │ 3个路径  │ 手动   │ [禁用] │ [详情] │ │
│  │              │            │          │        │        │ [▶立即]│ │
│  │              │            │          │        │        │ [编辑] │ │
│  └──────────────┴────────────┴──────────┴────────┴────────┴─────────┘ │
│                                                                         │
│  选中任务详情： 工作文档备份                                            │
│  ┌───────────────────────────────────────────────────────────────┐    │
│  │  任务名称：     工作文档备份                                  │    │
│  │  目标仓库：     本地备份仓库                                  │    │
│  │  备份路径：     /home/user/work                               │    │
│  │  排除规则：     *.tmp, node_modules/, .git/                   │    │
│  │  标签：         work, daily                                   │    │
│  │  调度设置：     每天 02:00 执行                               │    │
│  │  上次执行：     2025-10-20 02:00:00（成功）                   │    │
│  │  下次执行：     2025-10-21 02:00:00                           │    │
│  │                                                               │    │
│  │  最近5次执行记录：                                            │    │
│  │  [成功] 2025-10-20 02:00  │  快照: a3f5c8d2  │  +8文件        │    │
│  │  [成功] 2025-10-19 02:00  │  快照: b2x9k1m4  │  +12文件       │    │
│  │  [成功] 2025-10-18 02:00  │  快照: c5t2n8p7  │  +5文件        │    │
│  │  [失败] 2025-10-17 02:00  │  错误: 磁盘空间不足               │    │
│  │  [成功] 2025-10-16 02:00  │  快照: d8k5m2x9  │  +20文件       │    │
│  │                                                               │    │
│  │  [立即执行]  [编辑任务]  [查看历史]  [删除任务]              │    │
│  └───────────────────────────────────────────────────────────────┘    │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 6. 快照管理页面

### 6.1 快照列表

```
┌─────────────────────────────────────────────────────────────────────────┐
│  快照管理                                                               │
│                                                                         │
│  仓库: [本地备份仓库         ▼]  │  筛选: [____________] [搜索]        │
│                                                                         │
│  主机: [全部 ▼]  路径: [全部 ▼]  标签: [全部 ▼]  时间: [全部 ▼]      │
│                                                                         │
│  ┌─────────┬──────────────────┬─────────┬────────┬──────────┬───────┐ │
│  │ 快照ID  │ 创建时间          │ 主机名  │ 路径   │ 大小     │ 标签  │ │
│  ├─────────┼──────────────────┼─────────┼────────┼──────────┼───────┤ │
│  │ a3f5c8d2│ 2025-10-20 02:00 │ laptop  │ /home..│ 1.2 GB   │ work  │ │
│  ├─────────┼──────────────────┼─────────┼────────┼──────────┼───────┤ │
│  │ b2x9k1m4│ 2025-10-19 02:00 │ laptop  │ /home..│ 1.18 GB  │ work  │ │
│  ├─────────┼──────────────────┼─────────┼────────┼──────────┼───────┤ │
│  │ c5t2n8p7│ 2025-10-18 02:00 │ laptop  │ /home..│ 1.15 GB  │ work  │ │
│  ├─────────┼──────────────────┼─────────┼────────┼──────────┼───────┤ │
│  │ d8k5m2x9│ 2025-10-17 02:00 │ laptop  │ /home..│ 1.10 GB  │ work  │ │
│  └─────────┴──────────────────┴─────────┴────────┴──────────┴───────┘ │
│                                                                         │
│  选中快照： a3f5c8d2                                                    │
│  ┌───────────────────────────────────────────────────────────────┐    │
│  │  快照ID：       a3f5c8d2e91f7b23                              │    │
│  │  创建时间：     2025-10-20 02:00:15                           │    │
│  │  主机名：       my-laptop                                     │    │
│  │  用户名：       user                                          │    │
│  │  备份路径：     /home/user/work                               │    │
│  │  标签：         work, daily                                   │    │
│  │  父快照：       b2x9k1m4                                      │    │
│  │  文件数：       3,582                                         │    │
│  │  目录数：       425                                           │    │
│  │  总大小：       1.2 GB                                        │    │
│  │                                                               │    │
│  │  [浏览文件]  [恢复此快照]  [比较快照]  [管理标签]  [删除]    │    │
│  └───────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  批量操作：                                                             │
│  [☑] 已选择 3 个快照    [删除选中]  [添加标签]  [移除标签]           │
│                                                                         │
│  仓库维护：                                                             │
│  [清理仓库(Prune)]  [检查完整性]  [查看统计信息]                      │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 7. 恢复数据页面

### 7.1 恢复向导模式

```
┌─────────────────────────────────────────────────────────────────────────┐
│  恢复数据向导                                                           │
│                                                                         │
│  步骤 1/4: 选择仓库和快照                                               │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  选择仓库：                                                     │   │
│  │  ⚪ 本地备份仓库  (85个快照, 45 GB)                             │   │
│  │  ⚪ 远程SFTP仓库  (43个快照, 28 GB)                             │   │
│  │  ⚪ S3云端仓库    (120个快照, 98 GB)                            │   │
│  │                                                                 │   │
│  │  选择快照：                                                     │   │
│  │  ┌──────────────────────────────────────────────────────┐      │   │
│  │  │ ⚪ [最新] a3f5c8d2  2025-10-20 02:00  (1.2 GB)       │      │   │
│  │  │ ⚪        b2x9k1m4  2025-10-19 02:00  (1.18 GB)      │      │   │
│  │  │ ⚪        c5t2n8p7  2025-10-18 02:00  (1.15 GB)      │      │   │
│  │  │ ⚪        d8k5m2x9  2025-10-17 02:00  (1.10 GB)      │      │   │
│  │  │ ...                                                  │      │   │
│  │  └──────────────────────────────────────────────────────┘      │   │
│  │                                                                 │   │
│  │  或者搜索文件：                                                 │   │
│  │  [___________________________]  [搜索]                         │   │
│  │  （输入文件名或路径片段）                                       │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│                                      [取消]  [上一步]  [下一步 >]      │
└─────────────────────────────────────────────────────────────────────────┘
```

### 7.2 文件浏览与选择

```
┌─────────────────────────────────────────────────────────────────────────┐
│  恢复数据向导                                                           │
│                                                                         │
│  步骤 2/4: 选择要恢复的文件                                             │
│                                                                         │
│  快照: a3f5c8d2  │  时间: 2025-10-20 02:00  │  大小: 1.2 GB           │
│                                                                         │
│  搜索: [___________________________]  [🔍]                             │
│                                                                         │
│  ┌────────────────────────────────────┬────────┬───────┬─────────────┐ │
│  │ ☑ 📁 /home/user/work              │  类型  │ 大小  │ 修改时间    │ │
│  │   ├─☑ 📁 documents                │        │       │             │ │
│  │   │  ├─☑ 📄 report.docx            │ 文件   │ 2.5MB │ 2025-10-19  │ │
│  │   │  ├─☑ 📄 proposal.pdf           │ 文件   │ 1.2MB │ 2025-10-18  │ │
│  │   │  └─☑ 📁 archive                │        │       │             │ │
│  │   │     └─☑ 📄 old_report.docx     │ 文件   │ 1.8MB │ 2025-09-15  │ │
│  │   ├─☑ 📁 projects                  │        │       │             │ │
│  │   │  ├─☑ 📁 project_a               │        │       │             │ │
│  │   │  │  ├─☑ 📄 main.cpp             │ 文件   │ 15KB  │ 2025-10-20  │ │
│  │   │  │  └─☑ 📄 config.json          │ 文件   │ 2KB   │ 2025-10-15  │ │
│  │   │  └─☑ 📁 project_b               │        │       │             │ │
│  │   └─☑ 📁 temp                       │        │       │             │ │
│  │      └─☐ 📄 temp_file.tmp           │ 文件   │ 500KB │ 2025-10-20  │ │
│  └────────────────────────────────────┴────────┴───────┴─────────────┘ │
│                                                                         │
│  已选择: 12 个文件, 3 个文件夹  │  总大小: 850 MB                       │
│                                                                         │
│  [全选]  [全不选]  [展开全部]  [折叠全部]                              │
│                                                                         │
│                                      [取消]  [< 上一步]  [下一步 >]    │
└─────────────────────────────────────────────────────────────────────────┘
```

### 7.3 恢复选项配置

```
┌─────────────────────────────────────────────────────────────────────────┐
│  恢复数据向导                                                           │
│                                                                         │
│  步骤 3/4: 配置恢复选项                                                 │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  恢复目标路径：                                                 │   │
│  │  [/home/user/restore_______________________] [浏览...]         │   │
│  │                                                                 │   │
│  │  文件覆盖策略：                                                 │   │
│  │  ⚫ 始终覆盖已存在的文件                                        │   │
│  │  ⚪ 从不覆盖，跳过已存在的文件                                  │   │
│  │  ⚪ 仅当源文件较新时覆盖                                        │   │
│  │  ⚪ 每次都询问                                                  │   │
│  │                                                                 │   │
│  │  权限和属性：                                                   │   │
│  │  ☑ 恢复文件权限                                                 │   │
│  │  ☑ 恢复文件时间戳                                               │   │
│  │  ☑ 恢复文件所有者（需要管理员权限）                             │   │
│  │                                                                 │   │
│  │  高级选项：                                                     │   │
│  │  ☑ 恢复为稀疏文件（如果支持）                                   │   │
│  │  ☐ 验证恢复后的文件                                             │   │
│  │                                                                 │   │
│  │  恢复后操作：                                                   │   │
│  │  ☑ 恢复完成后打开目标文件夹                                     │   │
│  │  ☐ 恢复完成后运行脚本: [_______________] [浏览...]             │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│                                      [取消]  [< 上一步]  [下一步 >]    │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 8. 向导界面设计

### 8.1 创建仓库向导

#### 步骤1：选择仓库类型

```
┌─────────────────────────────────────────────────────────────────────────┐
│  创建新仓库 - 步骤 1/3                                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ○ 步骤1  →  ○ 步骤2  →  ○ 步骤3                                      │
│  选择类型     配置参数     完成                                         │
│                                                                         │
│  ─────────────────────────────────────────────────────────────────     │
│                                                                         │
│  请选择仓库类型：                                                       │
│                                                                         │
│  ┌────────────────────────┐  ┌────────────────────────┐               │
│  │  [图标]                │  │  [图标]                │               │
│  │                        │  │                        │               │
│  │  本地文件系统          │  │  SFTP                  │               │
│  │                        │  │                        │               │
│  │  在本地磁盘或网络      │  │  通过SSH连接到远程     │               │
│  │  共享上存储备份        │  │  服务器存储备份        │               │
│  │                        │  │                        │               │
│  │  推荐: 速度快          │  │  推荐: 安全可靠        │               │
│  │                        │  │                        │               │
│  │  [选择]                │  │  [选择]                │               │
│  └────────────────────────┘  └────────────────────────┘               │
│                                                                         │
│  ┌────────────────────────┐  ┌────────────────────────┐               │
│  │  [图标]                │  │  [图标]                │               │
│  │                        │  │                        │               │
│  │  Amazon S3 / S3兼容    │  │  REST Server           │               │
│  │                        │  │                        │               │
│  │  使用S3或兼容服务      │  │  使用restic REST       │               │
│  │  存储备份              │  │  服务器存储备份        │               │
│  │                        │  │                        │               │
│  │  推荐: 大容量云存储    │  │  推荐: 自建服务器      │               │
│  │                        │  │                        │               │
│  │  [选择]                │  │  [选择]                │               │
│  └────────────────────────┘  └────────────────────────┘               │
│                                                                         │
│  [其他类型...] (Azure, Google Cloud, Backblaze B2, rclone)            │
│                                                                         │
├─────────────────────────────────────────────────────────────────────────┤
│                                            [取消]  [上一步]  [下一步 >]│
└─────────────────────────────────────────────────────────────────────────┘
```

#### 步骤2：配置参数（以本地为例）

```
┌─────────────────────────────────────────────────────────────────────────┐
│  创建新仓库 - 步骤 2/3                                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ● 步骤1  →  ● 步骤2  →  ○ 步骤3                                      │
│  选择类型     配置参数     完成                                         │
│                                                                         │
│  ─────────────────────────────────────────────────────────────────     │
│                                                                         │
│  配置本地仓库                                                           │
│                                                                         │
│  仓库名称（用于在GUI中标识）：                                          │
│  [本地备份仓库_____________________________]                           │
│                                                                         │
│  仓库路径：                                                             │
│  [/srv/restic-repo_________________________] [浏览...]                 │
│                                                                         │
│  ⚠ 提示：建议选择一个空目录或新建目录                                  │
│                                                                         │
│  设置加密密码：                                                         │
│  密码：      [••••••••••••••••••••••••••••]  [显示]                    │
│  确认密码：  [••••••••••••••••••••••••••••]  [显示]                    │
│                                                                         │
│  密码强度： [████████░░░░░░░░░░░░] 中等                                │
│                                                                         │
│  ⚠ 警告：请务必牢记密码！密码丢失将无法恢复数据！                      │
│  建议：将密码保存到密码管理器中                                         │
│                                                                         │
│  密码存储选项：                                                         │
│  ⚪ 不保存密码（每次使用时输入）                                        │
│  ⚪ 在本次会话中记住密码                                                │
│  ⚫ 加密保存密码到系统密钥库（推荐）                                    │
│                                                                         │
│  高级选项：                                                             │
│  仓库版本： [2 (最新) ▼]                                               │
│                                                                         │
├─────────────────────────────────────────────────────────────────────────┤
│                                            [取消]  [< 上一步]  [下一步>]│
└─────────────────────────────────────────────────────────────────────────┘
```

#### 步骤3：确认并创建

```
┌─────────────────────────────────────────────────────────────────────────┐
│  创建新仓库 - 步骤 3/3                                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ● 步骤1  →  ● 步骤2  →  ● 步骤3                                      │
│  选择类型     配置参数     完成                                         │
│                                                                         │
│  ─────────────────────────────────────────────────────────────────     │
│                                                                         │
│  确认仓库配置                                                           │
│                                                                         │
│  请确认以下配置信息：                                                   │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  仓库名称：    本地备份仓库                                     │   │
│  │  仓库类型：    本地文件系统                                     │   │
│  │  仓库路径：    /srv/restic-repo                                 │   │
│  │  仓库版本：    2（支持压缩）                                    │   │
│  │  密码存储：    加密保存到系统密钥库                             │   │
│  │  设为默认：    ☑ 是                                             │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  点击"完成"后，系统将执行以下操作：                                    │
│  1. 验证仓库路径是否可用                                               │
│  2. 执行 restic init 命令初始化仓库                                    │
│  3. 保存仓库配置到数据库                                               │
│  4. 如果选择，保存密码到密钥库                                         │
│                                                                         │
│  预计耗时： < 10 秒                                                    │
│                                                                         │
│  ☑ 初始化完成后立即创建第一个备份任务                                  │
│                                                                         │
├─────────────────────────────────────────────────────────────────────────┤
│                                            [取消]  [< 上一步]  [完成]  │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 9. 进度对话框设计

### 9.1 备份进度

```
┌─────────────────────────────────────────────────────────────────────────┐
│  正在执行备份...                                         [_] [□] [X]   │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  任务：    工作文档备份                                                 │
│  仓库：    本地备份仓库                                                 │
│  状态：    正在处理文件...                                              │
│                                                                         │
│  当前文件： /home/user/work/projects/project_a/src/main.cpp            │
│                                                                         │
│  [████████████████████████████████████░░░░░░░░░░░] 68%                  │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  已处理：     3,250 / 4,780 文件                                │   │
│  │  数据量：     1.2 GB / 1.8 GB                                   │   │
│  │  新增文件：   8                                                 │   │
│  │  修改文件：   125                                               │   │
│  │  未修改：     3,117                                             │   │
│  │  传输速度：   12.5 MB/s                                         │   │
│  │  剩余时间：   约 2 分钟                                         │   │
│  │  已用时间：   5 分 30 秒                                        │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  ▼ 详细输出                                                             │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │ [2025-10-20 14:30:15] 开始备份...                              │   │
│  │ [2025-10-20 14:30:16] 扫描文件中...                            │   │
│  │ [2025-10-20 14:30:20] 发现 4,780 个文件, 1.8 GB                │   │
│  │ [2025-10-20 14:30:21] 开始处理文件...                          │   │
│  │ [2025-10-20 14:35:12] 处理进度: 68% (3,250/4,780)             │   │
│  │ ...                                                             │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│                                 [最小化到托盘]  [取消]                 │
└─────────────────────────────────────────────────────────────────────────┘
```

### 9.2 备份完成提示

```
┌─────────────────────────────────────────────────────────────────────────┐
│  备份完成                                                 [_] [□] [X]   │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ✓ 备份已成功完成！                                                    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  任务名称：     工作文档备份                                    │   │
│  │  仓库：         本地备份仓库                                    │   │
│  │  快照ID：       a3f5c8d2e91f7b23                                │   │
│  │  备份时间：     2025-10-20 14:30:00 - 14:40:25                 │   │
│  │  持续时间：     10 分 25 秒                                     │   │
│  │                                                                 │   │
│  │  文件统计：                                                     │   │
│  │  • 新增文件：   8 个 (125 MB)                                   │   │
│  │  • 修改文件：   125 个 (480 MB)                                 │   │
│  │  • 未修改：     3,647 个                                        │   │
│  │  • 总计：       3,780 个文件, 1.8 GB                            │   │
│  │                                                                 │   │
│  │  数据量：                                                       │   │
│  │  • 处理数据：   1.8 GB                                          │   │
│  │  • 新增数据：   605 MB                                          │   │
│  │  • 实际存储：   498 MB（去重后）                                │   │
│  │  • 去重率：     17.7%                                           │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  [查看快照详情]  [查看备份历史]  [关闭]                               │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 10. 设置页面

```
┌─────────────────────────────────────────────────────────────────────────┐
│  设置                                                                   │
│                                                                         │
│  ┌─────────────┬───────────────────────────────────────────────────┐   │
│  │             │                                                   │   │
│  │ 常规        │  启动设置：                                       │   │
│  │             │  ☑ 开机时自动启动                                 │   │
│  │ 备份        │  ☑ 启动时最小化到系统托盘                         │   │
│  │             │  ☑ 关闭按钮最小化到托盘（而非退出）               │   │
│  │ 界面        │                                                   │   │
│  │             │  默认仓库：                                       │   │
│  │ 高级        │  [本地备份仓库             ▼]                    │   │
│  │             │                                                   │   │
│  │ 日志        │  语言：                                           │   │
│  │             │  [简体中文                 ▼]                    │   │
│  │ 关于        │                                                   │   │
│  │             │  ─────────────────────────────────────────        │   │
│  │             │                                                   │   │
│  │             │  备份设置：                                       │   │
│  │             │  备份线程数： [4_____]                            │   │
│  │             │  网络超时：   [30____] 秒                         │   │
│  │             │  失败重试次数：[3_____] 次                        │   │
│  │             │                                                   │   │
│  │             │  通知设置：                                       │   │
│  │             │  ☑ 备份完成后显示通知                             │   │
│  │             │  ☑ 备份失败时显示通知                             │   │
│  │             │  ☑ 定时备份前5分钟提醒                            │   │
│  │             │                                                   │   │
│  │             │  密码设置：                                       │   │
│  │             │  密码缓存时长： [60____] 分钟                     │   │
│  │             │  （0表示不缓存，-1表示永久缓存）                  │   │
│  │             │                                                   │   │
│  └─────────────┴───────────────────────────────────────────────────┘   │
│                                                                         │
│                                         [恢复默认]  [应用]  [确定]     │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 11. 颜色与图标规范

### 11.1 配色方案

**主色调：**
- 主题色（蓝色）：#2196F3
- 成功（绿色）：#4CAF50
- 警告（橙色）：#FF9800
- 错误（红色）：#F44336
- 信息（灰色）：#607D8B

**背景色：**
- 主背景：#FFFFFF
- 次级背景：#F5F5F5
- 卡片背景：#FFFFFF
- 选中背景：#E3F2FD

**文字色：**
- 主文字：#212121
- 次文字：#757575
- 禁用文字：#BDBDBD

### 11.2 图标使用

- 仓库：💾 或文件夹图标
- 备份：📦 或上传图标
- 快照：📸 或时间图标
- 恢复：♻️ 或下载图标
- 设置：⚙️
- 成功：✓
- 失败：✗
- 警告：⚠️

---

## 12. 交互规范

### 12.1 按钮状态

- **默认状态：** 蓝色边框，白色背景
- **悬停状态：** 浅蓝色背景
- **按下状态：** 深蓝色背景
- **禁用状态：** 灰色文字，浅灰色边框

### 12.2 输入验证

- **实时验证：** 输入框失去焦点时验证
- **错误提示：** 红色边框+下方错误文字
- **成功提示：** 绿色✓图标

### 12.3 确认对话框

所有删除操作、不可逆操作都需要二次确认：

```
┌───────────────────────────────────────┐
│  确认删除                 [_] [□] [X] │
├───────────────────────────────────────┤
│                                       │
│  ⚠️  您确定要删除快照 "a3f5c8d2" 吗？│
│                                       │
│  此操作不可撤销！                     │
│                                       │
│  快照信息：                           │
│  • 创建时间：2025-10-20 14:30        │
│  • 大小：1.2 GB                       │
│                                       │
│  ☐ 同时执行prune清理数据              │
│                                       │
│              [取消]  [确定删除]       │
└───────────────────────────────────────┘
```

---

**文档结束**

本文档详细描述了Restic GUI的所有主要界面的布局、交互和设计规范。开发人员可以根据本文档使用Qt Designer创建UI文件。
